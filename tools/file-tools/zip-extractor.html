<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" href="favicon.png" sizes="32x32" type="image/png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced ZIP Extractor Tool</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<style>
:root {
  --bg-color: #f7f7f7;
  --card-bg: #fff;
  --text-color: #333;
  --button-bg: #4CAF50;
  --button-hover: #45a049;
  --drop-border: #2575fc;
  --progress-bg: #ddd;
  --progress-fill: #4CAF50;
}
body.dark {
  --bg-color: #181818;
  --card-bg: #242424;
  --text-color: #eee;
  --drop-border: #4AA8FF;
  --progress-bg: #333;
}
body {
  font-family: 'Inter', sans-serif;
  background: var(--bg-color);
  margin:0;
  padding:50px 0 20px;
  display:flex;
  justify-content:center;
  transition: background 0.3s, color 0.3s;
}
.container {
  background: var(--card-bg);
  width: 100%;
  max-width: 500px;
  border-radius: 12px;
  padding: 30px;
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
  text-align: center;
  transition: background 0.3s, color 0.3s;
}
h2 { margin-bottom: 20px; color: var(--text-color);}
.drop-area {
  padding: 25px;
  border: 2px dashed var(--drop-border);
  border-radius: 8px;
  margin-bottom: 20px;
  color: var(--drop-border);
  cursor: pointer;
  transition: all 0.3s ease;
}
.drop-area.dragover { background: rgba(37,117,252,0.15); transform: scale(1.02);}
input[type="file"]{ display:none;}
button {
  padding:12px 25px;
  border:none;
  border-radius:6px;
  font-size:16px;
  cursor:pointer;
  margin:5px;
  transition: all 0.3s ease;
}
#extractBtn { background: var(--button-bg); color:white; }
#extractBtn:hover { background: var(--button-hover); transform: translateY(-2px);}
#downloadAll { background: #008CBA; color:white; }
#downloadAll:hover { background: #007bb5; transform: translateY(-2px);}
#modeSwitch {
  position: fixed;
  top: 15px;
  right: 20px;
  background: var(--button-bg);
  color: white;
  border: none;
  padding: 8px 12px;
  border-radius: 5px;
  cursor:pointer;
  transition: all 0.3s;
}
#modeSwitch:hover { background: var(--button-hover); transform: translateY(-2px);}
ul {
  text-align:left;
  max-height:300px;
  overflow-y:auto;
  padding:0;
  margin-top:15px;
}
li { list-style:none; padding:5px 0; border-bottom:1px solid #ddd; color: var(--text-color);}
a { text-decoration:none; color:#008CBA; margin-left:5px;}
a:hover { text-decoration:underline;}
#progressContainer { width:100%; background: var(--progress-bg); border-radius:5px; height:15px; margin-top:10px; display:none;}
#progressBar { width:0%; height:100%; background: var(--progress-fill); transition: width 0.3s ease;}
@media (max-width:500px){
  .container{ padding:20px; }
  h2{ font-size:1.4rem; }
  .drop-area{ padding:20px; }
  button{ padding:10px 20px; font-size:15px; }
}
</style>
</head>
<body>

<button id="modeSwitch">Dark Mode</button>

<div class="container">
  <h2>Advanced ZIP Extractor Tool</h2>
  <div class="drop-area" id="dropArea">Drag & drop ZIP files here or click to upload</div>
  <input type="file" id="zipFiles" accept=".zip" multiple>
  <br>
  <button id="extractBtn">Extract ZIPs</button>
  <button id="downloadAll" disabled>Download All as ZIP</button>
  <div id="progressContainer"><div id="progressBar"></div></div>
  <ul id="fileList"></ul>
</div>

<script>
const zipFileInput = document.getElementById('zipFiles');
const extractBtn = document.getElementById('extractBtn');
const downloadAllBtn = document.getElementById('downloadAll');
const fileList = document.getElementById('fileList');
const dropArea = document.getElementById('dropArea');
const modeSwitch = document.getElementById('modeSwitch');
const progressContainer = document.getElementById('progressContainer');
const progressBar = document.getElementById('progressBar');

let darkMode=false;
let allFiles=[];

// Dark/Light mode
modeSwitch.addEventListener('click', ()=>{
  darkMode=!darkMode;
  document.body.classList.toggle('dark', darkMode);
  modeSwitch.textContent = darkMode ? 'Light Mode' : 'Dark Mode';
});

// Drag & Drop
dropArea.addEventListener('click', ()=>zipFileInput.click());
dropArea.addEventListener('dragover', e=>{ e.preventDefault(); dropArea.classList.add('dragover');});
dropArea.addEventListener('dragleave', e=>{ dropArea.classList.remove('dragover');});
dropArea.addEventListener('drop', e=>{
  e.preventDefault(); 
  dropArea.classList.remove('dragover');
  zipFileInput.files = e.dataTransfer.files;
});

// Extract multiple ZIPs with progress
extractBtn.addEventListener('click', async ()=>{
  const files = zipFileInput.files;
  if(!files.length){ alert("Please select ZIP files"); return;}
  allFiles=[]; fileList.innerHTML='';
  progressContainer.style.display='block';
  progressBar.style.width='0%';

  let totalFiles = 0;
  for(let f of files){
    try{
      const zip = await JSZip.loadAsync(f);
      totalFiles += Object.keys(zip.files).filter(k=>!zip.files[k].dir).length;
    }catch(e){}
  }
  if(totalFiles===0){ alert("No files found in ZIP(s)"); progressContainer.style.display='none'; return; }

  let processed=0;
  for(let f of files){
    try{
      const zip = await JSZip.loadAsync(f);
      for(let filename of Object.keys(zip.files)){
        const fileObj = zip.files[filename];
        if(!fileObj.dir){
          const blob = await fileObj.async("blob");
          allFiles.push({name:filename, blob});
          const li=document.createElement('li');
          li.textContent = filename;
          const a=document.createElement('a');
          a.href = URL.createObjectURL(blob);
          a.download=filename;
          a.textContent=" [Download]";
          li.appendChild(a);
          fileList.appendChild(li);

          processed++;
          progressBar.style.width = ((processed/totalFiles)*100) + "%";
        }
      }
    }catch(err){ alert("Failed to extract "+f.name+": "+err); }
  }
  progressContainer.style.display='none';
  if(allFiles.length>0) downloadAllBtn.disabled=false;
});

// Download all files as ZIP
downloadAllBtn.addEventListener('click', async ()=>{
  const newZip = new JSZip();
  allFiles.forEach(f=> newZip.file(f.name, f.blob));
  const content = await newZip.generateAsync({type:"blob"});
  const url = URL.createObjectURL(content);
  const a=document.createElement('a');
  a.href=url; a.download="AllFiles.zip";
  a.click();
});
</script>

</body>
</html>
